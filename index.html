<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TikTok Video Downloader</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple spinner animation */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #09f;
            animation: spin 1s ease infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen">
    <div class="container mx-auto p-4 max-w-2xl w-full">
        <div class="bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8">
            <!-- Header -->
            <div class="text-center mb-8">
                <i class="fab fa-tiktok text-5xl mb-4 text-cyan-400"></i>
                <h1 class="text-3xl md:text-4xl font-bold">TikTok Video Downloader</h1>
                <p class="text-gray-400 mt-2">Paste a TikTok video link below to download it without a watermark.</p>
            </div>

            <!-- Input Form -->
            <form id="download-form" class="flex flex-col sm:flex-row gap-4">
                <input 
                    id="tiktok-url"
                    type="text" 
                    placeholder="Paste TikTok URL here..." 
                    class="flex-grow bg-gray-700 text-white rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-cyan-500 w-full"
                    required
                >
                <button 
                    type="submit" 
                    class="bg-cyan-500 hover:bg-cyan-600 text-gray-900 font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105 flex items-center justify-center"
                >
                    <i class="fas fa-download mr-2"></i>
                    <span>Download</span>
                </button>
            </form>

            <!-- Status/Result Area -->
            <div id="status" class="mt-8 text-center">
                <!-- Spinner will be shown here -->
            </div>
            <div id="result" class="mt-8 hidden">
                <!-- Results will be populated here -->
            </div>
        </div>
        
        <!-- Disclaimer Footer -->
        <footer class="text-center mt-8 text-gray-500 text-sm">
            <p>This tool is for personal use only. Please respect the intellectual property rights of the content creators.</p>
        </footer>
    </div>

    <script>
        const downloadForm = document.getElementById('download-form');
        const urlInput = document.getElementById('tiktok-url');
        const statusDiv = document.getElementById('status');
        const resultDiv = document.getElementById('result');

        // UPDATED API ENDPOINT: Using another service.
        // These free APIs are unstable. If this one fails, it may need to be replaced again.
        const API_ENDPOINT = 'https://savetik.co/api/ajaxSearch';

        downloadForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const videoUrl = urlInput.value.trim();

            if (!videoUrl) {
                showError('Please paste a TikTok URL.');
                return;
            }

            clearResults();
            showSpinner();

            try {
                // This API expects a POST request with the URL in a 'q' parameter.
                const response = await fetch(API_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded'
                    },
                    body: `q=${encodeURIComponent(videoUrl)}&lang=en`
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok. The API might be down.');
                }

                const data = await response.json();
                
                // The new API returns HTML content in the 'data' field when the status is 'ok'
                if (data.status === 'ok' && data.data) {
                    displayResults(data.data);
                } else {
                    throw new Error(data.mess || 'Could not fetch video. The URL might be invalid, private, or the service is temporarily down.');
                }

            } catch (error) {
                console.error('Error fetching video:', error);
                showError(error.message);
            } finally {
                hideSpinner();
            }
        });
        
        function showSpinner() {
            statusDiv.innerHTML = '<div class="spinner mx-auto"></div>';
        }

        function hideSpinner() {
            statusDiv.innerHTML = '';
        }

        function showError(message) {
            statusDiv.innerHTML = `<p class="text-red-400 bg-red-900/50 p-3 rounded-lg">${message}</p>`;
        }
        
        function clearResults() {
            statusDiv.innerHTML = '';
            resultDiv.innerHTML = '';
            resultDiv.classList.add('hidden');
        }

        function displayResults(htmlContent) {
            resultDiv.classList.remove('hidden');
            
            // Create a temporary container to parse the HTML string
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlContent;

            // Extract the parts we want to display to avoid injecting unwanted scripts or styles
            const thumbnail = tempDiv.querySelector('.video-thumbnail-img')?.outerHTML || '';
            const title = tempDiv.querySelector('.video-title')?.outerHTML || '';
            const author = tempDiv.querySelector('.video-author-name')?.outerHTML || '';
            const downloadItems = tempDiv.querySelector('.download-items')?.outerHTML || '';

            // Construct clean HTML to inject into our page
            resultDiv.innerHTML = `
                <div class="bg-gray-700/50 rounded-lg p-6 flex flex-col items-center gap-4">
                    ${thumbnail}
                    <div class="text-center">
                        ${author}
                        ${title}
                    </div>
                    <div class="w-full flex flex-col items-center gap-3 mt-4">
                         ${downloadItems}
                    </div>
                </div>`;
            
            // The new API returns a full HTML block. We need to find the new buttons and style them.
            const downloadLinks = resultDiv.querySelectorAll('.download-items a');
            downloadLinks.forEach(link => {
                link.className = ''; // Clear existing classes
                link.classList.add('block', 'w-full', 'max-w-xs', 'bg-green-500', 'hover:bg-green-600', 'text-white', 'font-bold', 'py-3', 'px-6', 'rounded-lg', 'transition-transform', 'transform', 'hover:scale-105', 'text-center', 'no-underline');
                link.innerHTML = `<i class="fas fa-download mr-2"></i> ${link.textContent}`;
                link.target = "_blank"; // Ensure download links open in a new tab
            });
        }

    </script>
</body>
</html>

